---
title: "Are US IMDb users biased against foreign movies?" 
author: <font size='8'>Calcutta Coders <br> Grace South, Fletcher Adams and Mark Corray</font>
institute: <font size='10'>University of Edinburgh</font>
date: <font size = '6'>`r Sys.Date()`</font>
output:
  revealjs::revealjs_presentation:
    self_contained: false
---
---

```{r setup, include=FALSE}
library(rmarkdown)
library(tidyverse)
library(tidymodels)
library(palmerpenguins)
library(knitr)
library(revealjs)
library(broom)
library(ggridges)
library(here)
```

```{r chunk-output, include = FALSE}
knitr::opts_chunk$set(fig.retina = 3, dpi = 300, fig.width = 6, fig.asp = 0.618, out.width = "80%")
```


```{r read-data, include = FALSE}
imdb <- read.csv(file = here("data/IMDb_movies.csv"), header = TRUE, skip = 1, na.strings = c("NA", "", "None"))
imdb2019 <- read.csv(file = here("data/imdb-merge.csv"))
```
## R Markdown

This is an R Markdown presentation. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document.

## Slide with Bullets

- Bullet 1
- Bullet 2
- Bullet 3

## Slide with R Output

```{r cars, echo = TRUE}
imdb %>%
  ggplot(aes(x = votes, y = avg_vote)) +
  geom_point(alpha = 0.1) +
  labs(
    title = "Average Rating Based on the Popularity of Movie",
    x = "Number of Votes",
    y = "Average Rating"
  )
```

## Slide with Plot

```{r pressure}
imdb_country <- imdb %>%
   mutate(country = sub("\\ ", "", country)) %>%
   separate_rows(country, sep = "\\,")
   
imdb_country %>%
   count(country) %>%
   arrange(desc(n))
 
imdb_country %>%
   filter(
     country == c("USA", "France", "UK", "India", "Italy", "Germany", "Japan", "Canada", "Spain", "Hong Kong", "Turkey", "Belgium")
   ) %>%
   group_by(country) %>%
   summarise(
     mean_rating = mean(avg_vote, na.rm = TRUE),
     median_rating = median(avg_vote, na.rm = TRUE)
     ) %>%
   arrange(desc(mean_rating))
 
 imdb_country %>%
   filter(country == c("USA", "France", "UK", "India", "Italy", "Germany", "Japan", "Canada", "Spain", "Hong Kong", "Turkey", "Belgium")) %>%
   ggplot(aes(x = avg_vote, y = country, fill = country)) +
   geom_density_ridges(alpha = 0.5, show.legend = FALSE) +
   labs(
     title = "Distribution of IMDb Average Ratings",
     subtitle = "for top 12 countries who have produced the most films",
     x = "Average rating",
     y = "Country"
   )
```

