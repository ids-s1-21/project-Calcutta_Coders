---
title: "Are Subtitles a One-Inch Barrier for American IMDb users?" 
author: <font size='8'>Calcutta Coders <br> Grace South, Fletcher Adams and Mark Corray</font>
institute: <font size='10'>University of Edinburgh</font>
date: <font size = '6'>`r Sys.Date()`</font>
output:
  revealjs::revealjs_presentation:
    self_contained: false
---
---

```{r setup, include=FALSE}
library(rmarkdown)
library(tidyverse)
library(tidymodels)
library(palmerpenguins)
library(knitr)
library(revealjs)
library(broom)
library(ggridges)
library(here)
library(gt)
```

```{r chunk-output, include = FALSE}
knitr::opts_chunk$set(fig.retina = 3, dpi = 300, fig.width = 6, fig.asp = 0.618, out.width = "80%")
```


```{r read-data, include = FALSE}
imdb <- read.csv(file = here("data/IMDb_movies.csv"), header = TRUE, skip = 1, na.strings = c("NA", "", "None"))
imdb1990 <- read.csv(file = here("data/imdb-merge.csv"))
```
## Are US IMDb users biased against foreign movies?
- Investigating how the average rating of US and non-US users is influenced by country of production
- Exploring the influence of other variables including genre and income (US or worldwide) have on this relationship

## Average Rating

```{r average-rating, echo = FALSE, warning = FALSE}
imdb %>%
  ggplot(aes(x = avg_vote)) +
  geom_histogram(binwidth = 0.5) +
  labs(
    title = "Distribution of Average Rating",
    x = "Average Rating",
    y = "Frequency"
  ) +
  theme_minimal()
```

## Average Rating by Country

```{r average-rating-country-table, echo = FALSE, warning = FALSE}
imdb_country <- imdb %>%
  mutate(country = sub("\\ ", "", country)) %>%
  separate_rows(country, sep = "\\,") %>%
  mutate(country = case_when(
    country == "HongKong" ~ "Hong Kong",
    TRUE ~ country)) %>%
  filter(
     country %in% c("USA", "France", "UK", "India", "Italy", "Germany", "Japan", "Canada", "Spain", "Hong Kong", "Turkey", "Belgium")
   )

imdb_country %>%
  group_by(country) %>%
  summarise(
    mean_rating = mean(avg_vote, na.rm = TRUE),
    median_rating = median(avg_vote, na.rm = TRUE)
    ) %>%
  arrange(desc(mean_rating)) %>%
  gt() %>%
  cols_label(
    country = "Country",
    mean_rating = "Mean Rating",
    median_rating = "Median Rating"
  )
```

## Average Rating by Country

```{r average-rating-country, echo = FALSE, warning = FALSE}
imdb_country %>%
  ggplot(aes(x = avg_vote, y = country, fill = country)) +
  geom_density_ridges(alpha = 0.5, show.legend = FALSE) +
  labs(
    title = "Distribution of IMDb Average Ratings",
    subtitle = "for top 12 countries who have produced the most films",
    x = "Average rating",
    y = NULL
  ) +
  theme_minimal()
```

## Comparison of US vs. non-US users' average rating by country 

```{r country-us-rating, echo = FALSE, warning = FALSE}
imdb1990_country <- imdb1990 %>%
  separate_rows(country, sep = "\\,") %>%
  mutate(country = case_when(
    country == "HongKong" ~ "Hong Kong",
    TRUE ~ country
  )) %>%
  filter(
     country %in% c("USA", "France", "UK", "India", "Italy", "Germany", "Japan", "Canada", "Spain", "Hong Kong", "Turkey", "Belgium")
   ) 

imdb1990_country_longer <- imdb1990_country %>%
  pivot_longer(cols = c(us_rating, non_us_rating), names_to = "us_or_not", values_to = "rating")

imdb1990_country_longer %>%
  ggplot(aes(x = rating, fill = us_or_not)) +
  geom_density(alpha = 0.5) +
  facet_wrap(~ country) +
  labs(
    title = "Average Rating by US or non-US users",
    subtitle = "by country",
    x = "Average Rating",
    y = "Density",
    fill = NULL
  ) +
  theme_minimal()
```


<<<<<<< HEAD

## Distribution of US Average Rating for Genres

```{r data-analysis-genre, echo = FALSE, wanring = FALSE}
imdb1990_genre <- imdb1990 %>%
  mutate(genre = sub("\\ ", "", genre)) %>%
  separate_rows(genre, sep = "\\,") %>%
 mutate(genre = case_when(
    genre == "SciFi" ~ "Sci Fi",
    genre == "FilmNoir" ~ "Film Noir",
    TRUE ~ genre)) %>%
  distinct()

imdb1990_genre %>%
  filter(
    genre %in% c("Drama", "Comedy", "Action", "Horror", "Crime", "Thriller", "Romance", "Adventure", "Mystery", "Family")
  ) %>%
  ggplot(aes(x = us_rating, y = genre, fill = genre)) +
  geom_density_ridges(alpha = 0.5, show.legend = FALSE) +
  labs(
    title = "Distribution of US IMDb Average Rating by Genre",
    x = "Average Rating",
    y = "Genre"
  ) +
  theme_minimal()
```

## Top Genres for each Country
- Italy
  1. Drama (28%)
  2. Comedy (26%)
  3. Crime (6.1%)
  4. Horror (3.8%)
- Japan
  1. Drama (18%)
  2. Action (13%)
  3. Animation (13%)
  4. Comedy (8.6%)
- USA
  1. Drama (20%)
  2. Comedy (14%)
  3. Action (8.6%)
  4. Horror (7.4%)
  

## Which Genres Do americans think are the worst

```{r genre-linear-regression, echo = FALSE, warning = FALSE}
imdb1990_genre_regression <- imdb1990_genre %>%
  filter(genre %in% c("Drama", "Comedy", "Horror", "Animation", "Action", "Crime"))
imdb1990_genre_reg_US <- linear_reg() %>%
  set_engine("lm") %>%
  fit(us_rating ~ genre, data = imdb1990_genre_regression)
  tidy(imdb1990_genre_reg_US)
```

## Does US users rate films higher than non-US users if they generate more income?
```{r income, echo = FALSE, warning = FALSE}
imdb1990_income <- imdb1990 %>%
  pivot_longer(cols = c(us_rating, non_us_rating), names_to = "us_or_not", values_to = "rating") %>%
  transform(worlwide_gross_income = as.numeric(gsub("\\$", "", worlwide_gross_income)))
   
imdb1990_income %>%
  ggplot(aes(x = worlwide_gross_income, y = rating, color = us_or_not)) +
  geom_point(alpha = 0.1) +
  theme(axis.text.x = element_text(angle = 90)) +
  labs(
    title = "Worldwide Gross Income vs. Average Rating",
    x = "Worldwide Gross Income",
    y = "Average Rating",
    color = NULL
  ) +
  stat_smooth(method = "lm", se = FALSE)
```

## How is the US rating explained by worlwide income and country?
```{r income-regression, echo = FALSE, warning = FALSE}
imdb1990_country_income <- imdb1990 %>%
  transform(worlwide_gross_income = as.numeric(gsub("\\$", "", worlwide_gross_income))) %>%
  separate_rows(country, sep = "\\,") %>%
  mutate(country = case_when(
    country == "HongKong" ~ "Hong Kong",
    TRUE ~ country
  )) %>%
  filter(
     country %in% c("USA", "France", "UK", "India", "Italy", "Germany", "Japan", "Canada", "Spain", "Hong Kong", "Turkey", "Belgium")
   ) %>%
  distinct()

imdb1990_income_country_regression <- linear_reg() %>%
  fit(us_rating ~ worlwide_gross_income + country, data = imdb1990_country_income)
  tidy(imdb1990_income_country_regression)
  
imdb1990_income_regression <- linear_reg() %>%
  fit(us_rating ~ worlwide_gross_income, data = imdb1990_country_income)
  
glance(imdb1990_income_country_regression)$r.squared
glance(imdb1990_income_regression)$r.squared
```


>>>>>>> 6cee77440efc81f27a60490ab174a7ccb15eaa33
